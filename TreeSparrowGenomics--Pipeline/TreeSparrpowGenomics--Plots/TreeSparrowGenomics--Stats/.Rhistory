TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_discrete(na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 12, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 12, face = "bold"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
# Saves the panel ~
ggsave(TreeSparrowGenomics_Stat, file = "TreeSparrowGenomics--Stats.pdf",
device = cairo_pdf, width = 12, height = 16, scale = 1, dpi = 600)
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
# Creates the panel ~
#TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_manual(na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 12, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 12, face = "bold"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
# Creates the panel ~
#TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_manual(values = c("#1E90FF", "#fee391"), na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 12, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 12, face = "bold"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
# Creates the panel ~
#TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_manual(values = c("#1E90FF", "#fb6a4a"), na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 12, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 12, face = "bold"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
# Saves the panel ~
ggsave(TreeSparrowGenomics_Stat, file = "TreeSparrowGenomics--Stats.pdf",
device = cairo_pdf, width = 12, height = 16, scale = 1, dpi = 600)
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
# Creates the panel ~
#TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_manual(values = c("#1E90FF", "#fb6a4a"), na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 12, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 12, face = "bold"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
# Creates the panel ~
#TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_manual(values = c("#1E90FF", "#856D46"), na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 12, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 12, face = "bold"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
# Creates the panel ~
TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_manual(values = c("#1E90FF", "#856D46"), na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 12, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 12, face = "bold"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
# Saves the panel ~
ggsave(TreeSparrowGenomics_Stat, file = "TreeSparrowGenomics--Stats.pdf",
device = cairo_pdf, width = 12, height = 16, scale = 1, dpi = 600)
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
# Creates the panel ~
TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_manual(values = c("#1E90FF", "#856D46"), na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 10, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 8, face = "bold"),
axis.ticks.x = element_blank(),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
# Saves the panel ~
ggsave(TreeSparrowGenomics_Stat, file = "TreeSparrowGenomics--Stats.pdf",
device = cairo_pdf, width = 12, height = 16, scale = 1, dpi = 600)
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
ggsave(TreeSparrowGenomics_Stat, file = "TreeSparrowGenomics--Stats.jpeg",
width = 12, height = 16, scale = 1, dpi = 600)
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
# Creates the panel ~
TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_manual(values = c("#1E90FF", "#856D46"), na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 10, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 8, face = "bold"),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
# Saves the panel ~
ggsave(TreeSparrowGenomics_Stat, file = "TreeSparrowGenomics--Stats.pdf",
device = cairo_pdf, width = 12, height = 16, scale = 1, dpi = 600)
# Custom y-axis labels ~
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
# Creates the panel ~
TreeSparrowGenomics_Stat <-
ggplot(fulldfUp, aes(x = Population, y = Value, fill = REF)) +
#geom_violin(data = fulldfUp, aes(x = Population, y = Value),
#            fill = "#ffffff", colour = "#000000", show.legend = FALSE, alpha = .9, size = .45, width = 1) +
geom_boxplot(position = "dodge", outlier.shape = NA, width = .5, lwd = .25, colour = "#000000", alpha = .7) +
#stat_summary(data = fulldfUp, aes(x = Population, y = Value),
#             fun = mean, geom = "point", shape = 21, size = 2.5, alpha = 1, colour = "#000000", fill = "#df65b0") +
scale_fill_manual(values = c("#1E90FF", "#856D46"), na.translate = FALSE) +
facet_rep_grid(Stat ~. , scales = "free", labeller = labeller(Stat = ylabels)) +
scale_y_continuous(#limits = limits_fun,
#breaks = breaks_fun,
labels = labels_fun) +
theme(panel.background = element_rect(fill = "#ffffff"),
panel.grid.major = element_line(color = "#E5E7E9", linetype = "dashed", linewidth = .005),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.spacing.y = unit(1, "cm"),
axis.line = element_line(colour = "#000000", linewidth = .3),
axis.title = element_blank(),
axis.text.x = element_text(colour = "#000000", size = 10, face = "bold", angle = 45, vjust = 1, hjust = 1),
#axis.text.x = element_blank(),
axis.text.y = element_text(color = "#000000", size = 8, face = "bold"),
axis.ticks.x = element_line(color = "#000000", linewidth = .3),
axis.ticks.y = element_line(color = "#000000", linewidth = .3),
strip.background.y = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .3),
strip.text = element_text(colour = "#000000", size = 8, face = "bold"),
legend.position = "top",
legend.margin = margin(t = 0, b = 0, r = 0, l = 0),
legend.box.margin = margin(t = 10, b = 20, r = 0, l = 0),
legend.key = element_rect(fill = NA),
legend.background = element_blank()) +
guides(fill = guide_legend(title = "Reference", title.theme = element_text(size = 17, face = "bold"),
label.theme = element_text(size = 16),
override.aes = list(starshape = 15, size = 4.25, alpha = .7, starstroke = .15), nrow = 1, order = 1),
starshape = "none",
colour = "none")
# Saves the panel ~
ggsave(TreeSparrowGenomics_Stat, file = "TreeSparrowGenomics--Stats.pdf",
device = cairo_pdf, width = 12, height = 16, scale = 1, dpi = 600)
plot_index_labels <- 0
labels_fun <- function(z) {
plot_index_labels <<- plot_index_labels + 1L
switch(plot_index_labels,
scales::label_number(accuracy = 1, suffix = "X")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_percent(accuracy = 1, scale = 1, big.mark = "")(z),
scales::label_number(accuracy = 1, scale = 1/1000000, big.mark = "", suffix = "M")(z))}
ggsave(TreeSparrowGenomics_Stat, file = "TreeSparrowGenomics--Stats.jpeg",
width = 12, height = 16, scale = 1, dpi = 600)
